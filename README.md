### Introduction
- Welcome! This repository contains code used for analysis of HLA-Ab crystal structures for Sampurna Mukherjee (@SampurnaM) 's MPhil by thesis, titled "Computational Analysis of HLA-Ab interactions in the context of solid organ transplantation", to be submitted to Department of Biological Sciences, University of Cambridge in 2024, as a student of EMBL-EBI.  
- The code in this repository was created to analyse HLA-antibody complexes in the context of solid organ transplantation.
- **Please use the provided [yaml](https://github.com/SampurnaM/MPhil_HLA_Ab/blob/main/sampurna_mphil_env.yml) file**: , to create Conda environment and have dependencies installed for running code in this repo.
- The code is organised in three Jupyter notebooks :
  1) The first Jupyter Notebook: Follows Objective 1 of the thesis - finding epitope residues for HLA-A*1101- 2e3 complex (PDB ID: [6ID4](https://www.ebi.ac.uk/pdbe/entry/pdb/6id4 ) using epitope features: Presence in antibody-antigen binding interface(distance), solvent accessibility and presence of non-covalent interactions (NCIs) computed as Interaction Fingerprints. **This analysis is for static structures, i.e single PDB files**.
     
The module [sampurna_thesis](https://github.com/SampurnaM/MPhil_HLA_Ab/blob/main/sampurna_thesis.py) was written specifically for epitope feature computation from PDB files.  
The notebook has driver code using the functions in sampurna_thesis module and additional steps for data wrangling and final plots.


  [Objective 1 Notebook](https://github.com/SampurnaM/MPhil_HLA_Ab/blob/main/objective1_static_structure_analysis_and_plotting.ipynb)    
  
  2) The second Jupyter notebook: Follows Objective 2 of the thesis - computing the same epitope features across multiple conformations generated by molecular dynamics **(MD)** simulations to observe if **HLA epitope residues retain epitope features across multiple structural conformations generated by MD simulations**.
  ##### Metrics used for MD simulation analysis:  
  QA check: 1D-RMSD & RMSF  
  Analysis: 2D-RMSD, Fraction of native contacts, Solvent accessibility, Tanimoto Similarity Matrices and Clustered Tanimoto Similarity Matrices from Interaction Fingerprints  
     - Simulation software: [GROMACS 2022](https://manual.gromacs.org/2022/index.html)  
     - Key packages: [MDAnalysis](https://userguide.mdanalysis.org/stable/index.html) and [ProLIF](https://prolif.readthedocs.io/en/stable/)  
     
  [Objective 2 Notebook ](https://github.com/SampurnaM/MPhil_HLA_Ab/blob/main/objective2_md_analysis_and_plotting.ipynb)
  
  
  3) Finally, the molecular dynamics simulations were performed on EMBL-EBI's CODON cluster and the system setup was performed by launching Jupyter Notebooks inside CODON-SLURM cluster. The [setup notebook](https://github.com/SampurnaM/MPhil_HLA_Ab/blob/main/GROMACS_MD_setup.ipynb) is also available in this repository.

  Images generated from the analyses in the notebooks are present in the images folder.

  ### Simulation files
  If you are interested in having a copy of the raw simulation trajectory files, please write to arl@ebi.ac.uk . Thank you!
  

